# Validación de la identidad

Para garantizar que quien ejerce sus derechos es realmente el titular de los datos, Soyio incorpora un servicio de verificación de identidad integrado en el mismo componente.

No se requiere una integración adicional, ya que el servicio está incluido dentro del Privacy Center. Solo necesitas configurar su comportamiento según tus necesidades.

Ten en cuenta que la apariencia y el flujo de la validación siguen la configuración definida para el componente Disclosure, que provee la funcionalidad de verificación de identidad.

Puedes revisar más detalles en la sección de [verificación de identidad](/docs/integration-guide/disclosure/introduction).

## Comportamiento por defecto

Por defecto, la validación de identidad está habilitada en el Privacy Center y **es opcional para el usuario**. Esto quiere decir que la solicitud de ejercicio de derechos se enviará siempre y el usuario puede elegir validar su identidad inmediatamente o en un momento posterior.

En el sistema se creará su solicitud con estado **esperando verificación** y se le notificará al usuario que el procesamiento de su solicitud empezará una vez que complete su validación de identidad.

:::tip[Importante]
Este comportamiento por defecto es el recomendado, ya que no impide que el usuario pueda ejercer su derecho al permitir el envío de la solicitud, sin embargo condiciona que el usuario complete la validación de identidad para poder procesar su solicitud, que también es un requerimiento legal.
:::

## Configurar la validación como obligatoria

Puedes configurar la validación de identidad como **obligatoria para el usuario** y de esta manera el usuario no podrá enviar su solicitud hasta que valide su identidad correctamente.

### Configuración en el dashboard

Accede a la configuración de tu compañía en el dashboard corporativo y especifica el comportamiento del proceso de validación de identidad en la sección de **Solicitudes de derechos** según tus necesidades.

### Configuración vía API

Usando el endpoint `PATCH /api/v1/config` puedes hacer que la validación de identidad sea obligatoria en el proceso de solicitud de derechos. Define la opción `data_subject_request.mandatory_validation` en el body de la petición.

```json title="body"
{
  "data_subject_request": {
    "mandatory_validation": true
  }
}
```

---

## Niveles de validación

Al igual que en el módulo de Disclosure, puedes configurar diferentes niveles de validación de identidad para las solicitudes de derechos (Data Subject Requests). Estos niveles determinan qué verificaciones se realizarán cuando un usuario valida su identidad durante el proceso de ejercicio de derechos.

### Las tres verificaciones de validación

Soyio ofrece tres tipos de verificaciones que se pueden combinar para crear diferentes niveles de validación:

#### 1. Liveness Check (`liveness_check`)

Verifica que la persona que está realizando la validación es una persona real y está presente durante el proceso.

- **Detección de vida**: Prueba de que es una persona real, no una foto o video
- **Prevención de fraude**: Evita suplantación mediante fotos o máscaras
- **Dependencia**: Requiere que `id_scan_check` esté habilitado

#### 2. ID Scan Check (`id_scan_check`)

Verifica que el usuario presentó un documento de identidad válido y que los datos fueron extraídos correctamente.

- **Validación de documento**: Verifica autenticidad del documento de identidad
- **Extracción OCR**: Obtiene datos del documento (nombre, RUT, fecha de nacimiento, etc.)
- **Requerido para liveness**: Es necesario para habilitar `liveness_check`

#### 3. Government Check (`government_check`)

Verifica que el documento de identidad fue validado contra las bases de datos oficiales del gobierno.

- **Validación oficial**: Cruce con registros gubernamentales
- **Detección de fraudes**: Identifica documentos reportados como robados o perdidos
- **Consideración**: Puede requerir tiempo adicional de procesamiento

### Combinaciones comunes

| Nivel | `liveness_check` | `id_scan_check` | `government_check` |
|-------|------------------|------------------|-------------------|
| **Solo gobierno** | `false` | `false` | `true` |
| **Documento básico** | `false` | `true` | `false` |
| **Documento + Gobierno** | `false` | `true` | `true` |
| **Biométrica completa** | `true` | `true` | `false` |
| **Máxima seguridad** | `true` | `true` | `true` |

:::tip[Recomendación para DSR]
Para solicitudes de derechos, se recomienda la **validación biométrica completa** (`liveness_check: true`, `id_scan_check: true`, `government_check: false`) o **solo verificación gubernamental** (`government_check: true`) dependiendo del nivel de riesgo y los requisitos legales de tu organización.
:::

---

## Configuración de validación para DSR

Puedes configurar los niveles de validación para Data Subject Requests en dos lugares, con diferente prioridad:

### 1. Configuración general de validación (Validation-level)

La configuración a nivel de `validation` establece los valores **generales** para todos los procesos de validación.

**Ubicación:** Objeto [Configuration](../../api/resources/schemas/configuration.schema.mdx) en `validation.*`

**Campos:**
- `validation.liveness_check`
- `validation.id_scan_check`
- `validation.government_check`

### 2. Configuración específica de DSR (DSR-level)

La configuración a nivel de `data_subject_request` es específica para solicitudes de derechos y tiene prioridad sobre la configuración general de validación.

**Ubicación:** Objeto [Configuration](../../api/resources/schemas/configuration.schema.mdx) en `data_subject_request.*`

**Campos:**
- `data_subject_request.liveness_check`
- `data_subject_request.id_scan_check`
- `data_subject_request.government_check`

:::info[Prioridad de configuración]
La configuración de validación sigue el siguiente orden de prioridad:

1. **Configuración de DSR**: Si `config.data_subject_request` tiene configuración, se usa esa configuración
2. **Configuración general de validación**: Si `config.data_subject_request` no tiene configuración, se usa `config.validation`
3. **Valores por defecto**: Si ninguna de las anteriores tiene configuración, se usan los valores por defecto (`liveness_check: true`, `id_scan_check: true`, `government_check: false`)
:::

---

## Attestations resultantes en la Entity

Después de completar la validación, los attestations correspondientes se almacenan en la [Entity](../data-subjects#entity-entidad) asociada a la solicitud de derechos.

**Ejemplo de Entity con validación biométrica:**

```json
{
  "id": "ent_abc123",
  "agreement_id": "agr_xyz789",
  "user_reference": "user_456",
  "attestations": [
    {
      "kind": "liveness",
      "validated_at": "2026-01-19T12:00:00Z"
    },
    {
      "kind": "id_scan",
      "validated_at": "2026-01-19T12:00:00Z"
    },
    {
      "kind": "id_match",
      "validated_at": "2026-01-19T12:00:00Z"
    }
  ]
}
```

**Ejemplo de Entity con solo verificación gubernamental:**

```json
{
  "id": "ent_abc123",
  "agreement_id": "agr_xyz789",
  "user_reference": "user_456",
  "attestations": [
    {
      "kind": "government_check",
      "validated_at": "2026-01-19T12:05:00Z"
    }
  ]
}
```

Los attestations son **marcas** que registran qué verificaciones se realizaron sobre el usuario, permitiéndote conocer el nivel de validación que se completó.

Aprende más sobre entidades y attestations en la [guía de sujetos de datos](../data-subjects).

---

## Recursos relacionados

- [Sujetos de datos: Identity y Entity](../data-subjects)
- [Niveles de validación en Disclosure](../disclosure/validation-levels)
- [API: Configuration Schema](../../api/resources/schemas/configuration.schema.mdx)
- [API: Entity Schema](../../api/resources/schemas/entity.schema.mdx)
