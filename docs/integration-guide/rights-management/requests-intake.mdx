---
title: Recibe solicitudes de derecho
description: Integra el módulo de ejercicio de derechos en tu sitio web usando el componente Privacy Center del SDK de Soyio
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import SequenceDiagram from '../../../src/components/SequenceDiagram';

# Recibe solicitudes de derecho

:::info
Por ahora, este servicio está disponible **sólo para el SDK Web**.
:::

Usa el componente **Privacy Center** del [SDK de Soyio](https://github.com/Soyio-id/soy-io-widget) para integrar fácilmente el portal de recepción de solicitudes de derechos en tu sitio web, proporcionando a tus usuarios una interfaz intuitiva para enviar sus solicitudes.

<img src="/img/ejemplo-privacy-center-dsr.png" alt="Gestión de derechos example"/>

## Integración en modo público

Usa este modo para proporcionar acceso universal a la gestión de derechos, tanto para usuarios registrados como para visitantes.

**Características:**
- No requiere autenticación previa del usuario
- Permite que cualquier usuario ejerza sus derechos
- Incluye un paso de validación de identidad

Para integrar el Privacy Center en modo público, sigue la guía de [inicio rápido](./quickstart.mdx).

## Integración en modo autenticado

Usa este modo para proporcionar acceso a la gestión de derechos a usuarios autenticados en tu aplicación.

**Características:**
- Requiere que autentiques al usuario previamente en tu sistema
- Utiliza tokens de sesión como medida de seguridad
- No es necesario validar la identidad del usuario nuevamente

Para integrar el Privacy Center en modo autenticado, necesitas obtener un token de sesión usando la API de Soyio. Para obtener el token de sesión, debes proporcionar el `entity_id` de la entidad para la cual se generará el token.

:::tip
En caso de que no exista un `entity_id` para el usuario en tu sistema, no podrás obtener el token de sesión. En este caso, te recomendamos usar la integración en modo público.
:::

### Flujo de inicialización

<SequenceDiagram
  actors={[
    { id: 'user', label: 'Usuario' },
    { id: 'frontend', label: 'Frontend' },
    { id: 'privacy_center', label: 'Privacy Center' },
    { id: 'backend', label: 'Backend' },
    { id: 'soyio_api', label: 'Soyio API' },

  ]}
  actions={[
    {
      from: 'user',
      to: 'frontend',
      label: 'Ingresa a la sección de privacidad de su cuenta'
    },
    {
      from: 'frontend',
      to: 'backend',
      label: 'Solicita el token de sesión'
    },
    {
      from: 'backend',
      to: 'soyio_api',
      label: 'Solicita el token de sesión'
    },
    {
      from: 'soyio_api',
      to: 'backend',
      label: 'Devuelve el token de sesión'
    },
    {
      from: 'backend',
      to: 'frontend',
      label: 'Devuelve el token de sesión'
    },
    {
      from: 'frontend',
      to: 'privacy_center',
      label: 'Se inicializa el Privacy Center con el token de sesión'
    },
    {
      from: 'privacy_center',
      to: 'user',
      label: 'Despliega el Privacy Center'
    }
  ]}
/>

### Obtén el token de sesión

Una vez que el usuario se ha autenticado en tu sistema, usa el endpoint `POST /api/v1/privacy_center/session_token` para obtener el token de sesión.

<Tabs>
  <TabItem value="web" label="SDK Web" default>
```javascript title="Backend - Obtener token de sesión"
const getSessionToken = async (entityId) => {
  const response = await fetch('https://api.soyio.com/v1/privacy_center/session_token', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${process.env.SOYIO_API_KEY}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      entity_id: entityId
    })
  });

  if (!response.ok) {
    throw new Error(`Error: ${response.status}`);
  }

  const data = await response.json();
  return data.session_token;
};
```
  </TabItem>
</Tabs>

### Integra el componente en tu frontend

Una vez que tengas el token de sesión, configura el Privacy Center usando el token de sesión.

<Tabs>
  <TabItem value="web" label="SDK Web" default>
```javascript title="js/privacy-center.js"
import { PrivacyCenter } from "@soyio/soyio-widget";

const privacyCenterOptions = {
    sessionToken: "<session_token>", // Reemplaza con el token de sesión
    enabledFeatures: ['DataSubjectRequests', 'RequestTracking'],
    onEvent: (event) => {
        console.log('Evento del Privacy Center:', event);
        // Maneja los eventos según tus necesidades
    },
    onReady: () => {
        console.log('Privacy Center está listo');
    },
    appearance: {
        theme: 'soyio',
        variables: {
            colorPrimary: '#f54c27',
            colorBackground: '#ffffff'
        }
    },
    isSandbox: false
};

// Inicializa el Privacy Center
const privacyCenter = new PrivacyCenter(privacyCenterOptions);
privacyCenter.mount("#privacy-center-container");
```
  </TabItem>
</Tabs>

## Creación de la solicitud

Cuando un usuario envía una solicitud de ejercicio de derechos, se creará un nuevo [Data subject Request o DSR](../../api/resources/schemas/datasubjectrequest). Este recurso es el que mantendrá la trazabilidad de la solicitud y su estado a medida que se procese la solicitud.

## Correlación con webhooks usando referencias

Cada solicitud de ejercicio de derechos (DSR) puede incluir una **referencia opcional** (`request_reference`) que te permite correlacionar los webhooks y eventos que recibas de Soyio con tus propios sistemas de gestión.

### ¿Para qué sirve?

El campo `request_reference` te permite:

- **Correlacionar webhooks**: Identifica rápidamente a qué ticket, caso o registro de tu sistema corresponde cada notificación de webhook.
- **Seguimiento simplificado**: Mantén la trazabilidad entre tu sistema interno y las solicitudes procesadas en Soyio.
- **Automatización eficiente**: Facilita la integración programática con tus flujos de trabajo existentes.

### Cómo usar la referencia con el SDK

Cuando inicializas el Privacy Center, puedes pasar una referencia en las opciones principales. Esta referencia se asociará automáticamente a todas las solicitudes creadas desde ese componente:

<Tabs>
  <TabItem value="web" label="SDK Web" default>
```javascript title="Inicializar Privacy Center con referencia"
import { PrivacyCenter } from "@soyio/soyio-widget";

// Obtén el identificador de tu sistema (ej: ID de ticket, usuario, sesión)
const userTicketId = "ticket-12345";

const privacyCenterOptions = {
  companyId: "<company_id>", // O usa sessionToken para modo autenticado
  enabledFeatures: ['DataSubjectRequests', 'RequestTracking'],
  requestReference: userTicketId,
  onEvent: (event) => {
    console.log('Evento del Privacy Center:', event);

    // Cuando se crea una solicitud, la referencia estará incluida
    if (event.type === 'data_subject_request.created') {
      console.log('Solicitud creada con referencia:', event.data.request_reference);
      // Actualiza tu sistema interno con el ID de Soyio
      updateInternalTicket(userTicketId, event.data.id);
    }
  }
};

const privacyCenter = new PrivacyCenter(privacyCenterOptions);
privacyCenter.mount("#privacy-center-container");
```
  </TabItem>
</Tabs>

:::info Uso directo de la API
También puedes incluir el campo `request_reference` al crear solicitudes directamente mediante la [API de Soyio](../../api/resources/create-data-subject-request.api.mdx), especialmente útil cuando construyes tu propia interfaz personalizada o automatizas la creación de solicitudes desde tu backend.
:::

### Recibir la referencia en webhooks

Cuando Soyio envíe webhooks sobre cambios en el estado de la solicitud, el campo `request_reference` estará incluido en la carga útil del evento:

```json title="Ejemplo de webhook con referencia"
{
  "event": "data_subject_request.updated",
  "data": {
    "id": "dsr_abc123",
    "request_type": "access",
    "status": "processing",
    "request_reference": "ticket-12345",
    ...
  }
}
```

Esto te permite identificar inmediatamente el ticket o caso en tu sistema que corresponde a esta solicitud.

:::tip Buena práctica
Usa identificadores únicos y descriptivos como referencias (ej: `ticket-12345`, `caso-CRM-789`, `solicitud-2024-001`) para facilitar el debugging y el seguimiento.
:::

## Siguientes pasos

- [**Responde a las solicitudes de derecho**](./requests-management.mdx): Revisa cómo gestionar las solicitudes de derechos.
- [**Validación de la identidad**](./requests-validation.mdx): Revisa cómo validar la identidad del usuario.
- [**Notificaciones y recordatorios**](./notifications.mdx): Revisa cómo configurar las notificaciones y recordatorios.
- [**Personalización**](../consent/customization): Revisa cómo personalizar el Privacy Center.
